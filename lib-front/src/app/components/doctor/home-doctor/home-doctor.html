<div class="dashboard-container">
  <header class="dashboard-header">
    <div class="user-info">
      <h1>Panel de <span>Control M√©dico</span></h1>
      <p class="id-badge">Gesti√≥n de Reservas Disponibles</p>
    </div>
    <div class="header-actions">
      <button class="btn-secondary" routerLink="/pacientes_de_doctor">Mis Pacientes</button>
      <button class="btn-logout" (click)="salir()">Cerrar Sesi√≥n</button>
    </div>
  </header>

  <section class="filter-section">
    <div class="search-card">
      <div class="search-box">
        <input type="text" placeholder="Buscar nombre de paciente..." [(ngModel)]="nombre_filtro" class="main-input"/>
        
        <div class="filter-buttons">
          @if (nombre_filtro && paciente_filtrado.length === 0) {
            <button class="btn-search" (click)="filtrar()">üîç Filtrar</button>
          }
          @if (paciente_filtrado.length > 0) {
            <button class="btn-clear" (click)="eliminar_filtro()">Limpiar</button>
          }
        </div>
      </div>

      @if (paciente_filtrado.length > 0) {
        <div class="results-area animate-fade">
          <h3>Resultados encontrados:</h3>
          <div class="results-list">
            @for (nom of paciente_filtrado; track nom.id) {
              <div class="result-item">
                <span class="p-name">{{ nom.nombre_paciente }}</span>
                <span class="p-id">ID: {{ nom.id }}</span>
              </div>
            }
          </div>
        </div>
      }
    </div>
  </section>

  <section class="posts-section">
    <div class="section-header">
      <h2>Solicitudes Disponibles</h2>
      <span class="count-tag">{{ todo_post.length }} casos</span>
    </div>

    @if (validacion_1 === false || validacion_2 === false) {
      <div class="alert-box animate-shake">
        <span class="icon">‚ö†Ô∏è</span>
        {{ validacion_1 === false ? 'Ya eres el doctor asignado a este paciente.' : 'Este paciente ya est√° siendo atendido por otro doctor.' }}
      </div>
    }
    
    <div class="posts-grid">
      @for (usu of todo_post; track usu.id) {
        <div class="post-card" [class.assigned]="usu.doctor">
          <div class="post-status" [attr.data-status]="usu.doctor ? 'Asignado' : 'Pendiente'">
            {{ usu.doctor ? 'Ocupado' : 'Disponible' }}
          </div>
          
          <div class="post-body">
            <h3>{{ usu.descripcion_dolor }}</h3>
            <div class="post-info">
              <p><strong>Paciente:</strong> {{ usu.nombre_paciente }}</p>
              <p class="reserva-id">ID Reserva: #{{ usu.id }}</p>
            </div>
            <div class="doctor-badge">
              üë®‚Äç‚öïÔ∏è {{ usu.doctor ? 'Atendido por: ' + usu.doctor : 'Sin doctor asignado' }}
            </div>
          </div>

          <div class="post-actions">
            <button class="btn-attend" [disabled]="usu.doctor" (click)="atender(usu.id)">
              {{ usu.doctor ? 'No Disponible' : 'Atender Paciente' }}
            </button>
          </div>
        </div>
      }
    </div>

    @if (todo_post.length === 0) {
      <div class="empty-state">
        <div class="empty-icon">üìÇ</div>
        <p>No hay publicaciones disponibles en este momento.</p>
      </div>
    }
  </section>
</div>